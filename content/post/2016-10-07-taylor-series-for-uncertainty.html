---
layout: post
comments:  true
title: "基于泰勒展开的不确定性传递"
date: 2016-10-07
categories: [uncertainty]
published:  true
---



<div class="section level1">
<h1>1 两个输入变量</h1>
<p>假设随机变量<span class="math inline">\(Z\)</span>是随机变量<span class="math inline">\(X\)</span>和随机变量<span class="math inline">\(Y\)</span>的函数，函数关系如下</p>
<p><span class="math display">\[Z=f(X,Y)\]</span></p>
<p>其中<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>的均值分别为<span class="math inline">\(\overline{X}\)</span>和<span class="math inline">\(\overline{Y}\)</span>，方差分别为<span class="math inline">\(D_{X}\)</span><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>和<span class="math inline">\(D_{Y}\)</span>，协方差为<span class="math inline">\(D_{XY}\)</span>。对<span class="math inline">\(Z\)</span>进行关于<span class="math inline">\(\overline{X}\)</span>和<span class="math inline">\(\overline{Y}\)</span>泰勒展开可以得到</p>
<p><span class="math display">\[Z=f(\overline{X},\overline{Y})+f_{X}^{\prime}(\overline{X},\overline{Y})(X-\overline{X})+f_{Y}^{\prime}(\overline{X},\overline{Y})(Y-\overline{Y})+o(X,Y)\]</span></p>
<p>如果忽略高阶项<span class="math inline">\(o(X,Y)\)</span>，那么根据随机变量求和的期望和方差计算公式</p>
<p><span class="math display">\[\mathbb{E}(X+Y)=\mathbb{E}(X)+\mathbb{E}(Y)\]</span></p>
<p>和</p>
<p><span class="math display">\[\text{var}(X+Y)=\text{var}(X)+\text{var}(Y)+2\text{cov}(X,Y)\]</span></p>
<p>可以得到<span class="math inline">\(Z\)</span>的期望值与方差值分别如下</p>
<p><span class="math display">\[\overline{Z}=f(\overline{X},\overline{Y})\]</span></p>
<p>和</p>
<p><span class="math display">\[D_{Z}=f_{X}^{\prime}(\overline{X},\overline{Y})^{2}D_{X}+f_{Y}^{\prime}(\overline{X},\overline{Y})^{2}D_{Y}+2f_{X}^{\prime}(\overline{X},\overline{Y})f_{Y}^{\prime}(\overline{X},\overline{Y})D_{XY}\]</span></p>
<!--more-->
<p>如果我们对<span class="math inline">\(X\)</span>、<span class="math inline">\(Y\)</span>和<span class="math inline">\(Z\)</span>取对数，那么理论上存在</p>
<p><span class="math display">\[\ln Z=g(\ln X,\ln Y)\]</span></p>
<p>根据泰勒展开公式，有</p>
<p><span class="math display">\[\begin{align}
\ln Z &amp; =g(\overline{\ln X},\overline{\ln Y})+g_{\ln X}^{\prime}(\overline{\ln X},\overline{\ln Y})(\ln X-\overline{\ln X})+\nonumber \\
 &amp; g_{\ln Y}^{\prime}(\overline{\ln X},\overline{\ln Y})(\ln Y-\overline{\ln Y})+o(\overline{\ln X},\overline{\ln Y})
\end{align}\]</span></p>
<p>其中</p>
<p><span class="math display">\[\begin{align}
g_{\ln X}^{\prime}(\overline{\ln X},\overline{\ln Y}) &amp; =\left[\dfrac{\partial\ln Z}{\partial\ln X}\right]_{\ln X=\overline{\ln X},\,\ln Y=\overline{\ln Y}}\\
 &amp; =\left[\dfrac{\partial Z}{Z}/\dfrac{\partial X}{X}\right]_{X=\overline{X},\,Y=\overline{Y}}\\
 &amp; =S_{X}(\overline{X},\overline{Y})
\end{align}\]</span></p>
<p>这里<span class="math inline">\(S_X\)</span>表示参数<span class="math inline">\(X\)</span>的相对敏感性系数(类似于经济学中的弹性系数)<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>。根据以上推导可以得到<span class="math inline">\(\ln Z\)</span>的期望值与方差值分别如下</p>
<p><span class="math display">\[\overline{\ln Z}=g(\overline{\ln X},\overline{\ln Y})\]</span></p>
<p>和</p>
<p><span class="math display">\[\begin{align}
D_{\ln Z} &amp; =S_{X}(\overline{X},\overline{Y})^{2}D_{\ln X}+S_{Y}(\overline{X},\overline{Y})^{2}D_{\ln Y}+\nonumber \\
 &amp; 2S_{X}(\overline{X},\overline{Y})S_{Y}(\overline{X},\overline{Y})D_{\ln X\ln Y}
\end{align}\]</span></p>
</div>
<div class="section level1">
<h1>2 多个输入变量</h1>
<p>对于更一般的情况，假设<span class="math inline">\(Z\)</span>是变量<span class="math inline">\(X_{1},X_{2},\cdots,X_{n}\)</span>的函数</p>
<p><span class="math display">\[Z=f(X_{1},X_{2},\cdots,X_{n})\]</span></p>
<p>同时有</p>
<p><span class="math display">\[\ln Z=g(\ln X_{1},\ln X_{2},\cdots,\ln X_{n})\]</span></p>
<p>那么<span class="math inline">\(Z\)</span>的期望值与方差值分别如下</p>
<p><span class="math display">\[\overline{Z}=f(\overline{X}_{1},\overline{X}_{2},\cdots,\overline{X}_{n})\]</span></p>
<p>和</p>
<p><span class="math display">\[\begin{align}
D_{Z} &amp; =\sum_{i=1}^{n}f_{X_{i}}^{\prime}(\overline{X}_{1},\overline{X}_{2},\cdots,\overline{X}_{n})^{2}D_{X_{i}}+\nonumber \\
 &amp; \sum_{i=1}^{n}\sum_{j=1}^{n}f_{X_{i}}^{\prime}(\overline{X}_{1},\overline{X}_{2},\cdots,\overline{X}_{n})f_{X_{j}}^{\prime}(\overline{X}_{1},\overline{X}_{2},\cdots,\overline{X}_{n})D_{X_{i}X_{j}}
\end{align}\]</span></p>
<p>以及<span class="math inline">\(\ln Z\)</span>的期望值与方差值分别如下</p>
<p><span class="math display">\[\overline{\ln Z}=g(\overline{\ln X_{1}},\overline{\ln X_{2}},\cdots,\overline{\ln X_{n}})\]</span></p>
<p>和</p>
<p><span class="math display">\[\begin{align}
D_{\ln Z} &amp; =\sum_{i=1}^{n}S_{X_{i}}(\overline{X}_{1},\overline{X}_{2},\cdots,\overline{X}_{n})^{2}D_{\ln X_{i}}+\nonumber \\
 &amp; \sum_{i=1}^{n}\sum_{j=1}^{n}S_{X_{i}}(\overline{X}_{1},\overline{X}_{2},\cdots,\overline{X}_{n})S_{X_{j}}(\overline{X}_{1},\overline{X}_{2},\cdots,\overline{X}_{n})D_{\ln X_{i}\ln X_{j}}
\end{align}\]</span></p>
</div>
<div class="section level1">
<h1>3 举个例子</h1>
<p>假设随机变量<span class="math inline">\(Z\)</span>与随机变量<span class="math inline">\(X\)</span>和随机变量<span class="math inline">\(Y\)</span>满足如下的函数关系</p>
<p><span class="math display">\[Z=e^X\sin^2Y\]</span></p>
<p><img src="/post/2016-10-07-taylor-series-for-uncertainty_files/figure-html/persp_plot-1.png" width="672" /></p>
<p>这里<span class="math inline">\(X\sim\mathcal{LN}(0.5,0.04)\)</span>，<span class="math inline">\(Y\sim\mathcal{LN}(0.3,0.01)\)</span>，并且<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>互相独立。分别将<span class="math inline">\(Z\)</span>对<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>求导，可以得到</p>
<p><span class="math display">\[\dfrac{\partial Z}{\partial X}=e^{X}\sin^{2}Y\]</span></p>
<p>和</p>
<p><span class="math display">\[\dfrac{\partial Z}{\partial Y}=2e^{X}\sin Y\cos Y\]</span></p>
<p>另外，对于<span class="math inline">\(X\sim\mathcal{LN}(\mu,\sigma^2)\)</span>，有</p>
<p><span class="math display">\[\mathbb{E}(X)=e^{\mu+\frac{1}{2}\sigma^{2}}\]</span></p>
<p>和</p>
<p><span class="math display">\[\text{var}(X)=(e^{\sigma^{2}}-1)e^{2\mu+\sigma^{2}}\]</span></p>
<p>那么有<span class="math inline">\(\overline{X}=1.682\)</span>，<span class="math inline">\(D_{X}=0.115\)</span>，<span class="math inline">\(\overline{Y}=1.357\)</span>，<span class="math inline">\(D_{Y}=0.018\)</span>。则<span class="math inline">\(Z\)</span>的期望值与方差值的计算结果分别如下</p>
<p><span class="math display">\[\overline{Z}=e^{\overline{X}}\sin^{2}\overline{Y}=
5.134\]</span></p>
<p>和</p>
<p><span class="math display">\[D_{Z}=f_{X}^{\prime}(\overline{X},\overline{Y})^{2}D_{X}+f_{Y}^{\prime}(\overline{X},\overline{Y})^{2}D_{Y}=
3.135\]</span></p>
<p>如果采用Monte Carlo随机模拟，估算出的<span class="math inline">\(\overline{Z}=5.37\)</span>，<span class="math inline">\(D_{Z}=4.82\)</span>。</p>
<p><img src="/post/2016-10-07-taylor-series-for-uncertainty_files/figure-html/mc_plot-1.png" width="768" /></p>
<p>另外，<span class="math inline">\(\ln Z\)</span>的期望值与方差值的计算结果分别如下</p>
<p><span class="math display">\[\overline{\ln Z}=\ln(e^{\overline{X}}\sin^{2}\overline{Y})=
1.636\]</span></p>
<p>和</p>
<p><span class="math display">\[D_{\ln Z}=S_{X}(\overline{X},\overline{Y})^{2}D_{\ln X}+S_{Y}(\overline{X},\overline{Y})^{2}D_{\ln Y}=
0.117\]</span></p>
<p>如果采用Monte Carlo随机模拟，估算出的<span class="math inline">\(\overline{\ln Z}=1.617\)</span>，<span class="math inline">\(D_{\ln Z}=0.119\)</span>。</p>
<p><img src="/post/2016-10-07-taylor-series-for-uncertainty_files/figure-html/mc_plot_ln-1.png" width="768" /></p>
</div>
<div class="section level1">
<h1>脚注</h1>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p><span class="math inline">\(D_{X}\)</span>实际上是<span class="math inline">\(D_{XX}\)</span>的简写。<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>注意这里用到了变量替换的方法。<span class="math inline">\(g_{\ln X}^{\prime}\)</span>是<span class="math inline">\(\overline{\ln X}\)</span>和<span class="math inline">\(\overline{\ln Y}\)</span>的函数，而<span class="math inline">\(S_{X}\)</span>是<span class="math inline">\(\overline{X}\)</span>和<span class="math inline">\(\overline{Y}\)</span>的函数。<a href="#fnref2" class="footnote-back">↩</a></p></li>
</ol>
</div>
