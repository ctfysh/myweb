<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="//gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.87.0" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Catfish &middot; Tiger&#39;s home</title>

  
  <link type="text/css" rel="stylesheet" href="/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="/css/poole.css">
  <link type="text/css" rel="stylesheet" href="/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="/css/hyde.css">
  <link type="text/css" rel="stylesheet" href="/css/custom.css">
    <link type="text/css" rel="stylesheet" href="/css/fonts.css">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/catfish.png">
  <link rel="shortcut icon" href="/favicon.ico">

  
  <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Catfish" />
  


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">





    
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    



</head>

  <body class="theme-base-0d ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="/"><h1>Catfish</h1></a>
      <p class="lead">
       R is the brush, math is the pigment, nature is the scenery, and science is the picture. 
      </p>
    </div>

    <nav class="sidebar-nav">
      
      
        <a class="sidebar-nav-item active" href="/">Home</a>
        <a class="sidebar-nav-item " href="/about/"> About </a><a class="sidebar-nav-item " href="/post/"> Archives </a><a class="sidebar-nav-item " href="/categories/"> Categories </a><a class="sidebar-nav-item " href="/resume/"> Resume </a><a class="sidebar-nav-item " href="https://github.com/ctfysh"> GitHub </a>
    </nav>

    
  </div>
</aside>

    <main class="content container">
    <div class="posts">

<article class="post">
  <h1 class="post-title">
    <a href="/post/2019/10/01/how-to-make-national-flag/">如何绘制国旗？</a>
  </h1>
  <time datetime="2019-10-01T00:00:00Z" class="post-date">2019年10月1日</time>
  


<p>今天是新中国70华诞，是全中国人民最重要的节日。在这个特殊的日子，作为一个伪码农，我选择了这样一种方式，表达对祖国最诚挚的爱。</p>
<div id="section" class="section level1">
<h1>1 准备工作</h1>
<p>“工欲善其事，必先利其器。”作为一个R的重度发烧友，用R绘图是一项基本技能。我们通常的绘图思路是先构图，然后绘制。然而，自从<code>tidyverse</code>包出现后，绘图与数据分析就紧密结合在一起。可以说，图形只是数据的一种可视化方式，所以在绘图前做好数据处理工作是十分必要的。那么，如何构建绘图的数据呢？答案很简单，就是利用<code>sf</code>包，因为它能够提供一个基于WKT的几何图形数据格式（见<a href="https://cran.r-project.org/web/packages/sf/vignettes/sf1.html">Simple Features for R</a>）。</p>
<p>接下来，我们需要了解五星红旗的绘制标准，包括：国旗（GB 12982-2004）和国旗颜色标准样品（GB 12983-2004）。看过标准后我才发现，看似简单的国旗其实有许多细节需要注意：五角星的大小、位置、角度、颜色以及红旗旗面的尺寸与颜色都是有讲究的。</p>
<p>在对绘图工具和绘图规范有了比较好的理解后，我们就可以着手绘图数据的设计与处理。</p>
</div>
<div id="section-1" class="section level1">
<h1>2 五角星和旗面绘制</h1>
<p>如何绘制五角星和旗面？对于一个熟悉WKT格式的人来说，这个问题可以转化为一个数据问题。我们可以用<code>LINESTRING</code>（多段线）或者<code>POLYGON</code>（多边形）这两种格式来处理数据，也就是确定好五角星和旗面矩形的每个顶点的横纵坐标并按顺序排列即可。为了保证线条闭合，必须首尾的横纵坐标是一致的。</p>

  
  <div class="read-more-link">
    <a href="/post/2019/10/01/how-to-make-national-flag/">Read More →</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="/post/2017/02/06/tables-package-usage/">生产复杂表格的R软件包：tables</a>
  </h1>
  <time datetime="2017-02-06T00:00:00Z" class="post-date">2017年2月6日</time>
  


<p>数据的输入输出一直是数据处理比较重要的问题。我们常见的数据表格的表头设计一般都比较复杂，存在着表头套表头的现象，而这种表格的结构对于一个数据分析软件来说是没法理解的。数据软件所能理解的表格是那种标准化的表格，也就是第一行是字段名（也就是变量名），从第二行到表格结束就是具体的内容（也就是变量的取值，或者叫实例）。这样除去第一行后，每一行表示一个实例（统计上叫一个观测，或者某个对象的属性），每一列表示一个变量的取值。如我们经常用到的<code>iris</code>数据表（为了简便，随机从每个Species类别中选取了1个数据）：</p>
<table>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4.8</td>
<td align="right">3.1</td>
<td align="right">1.6</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.6</td>
<td align="right">2.9</td>
<td align="right">3.6</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td align="right">5.7</td>
<td align="right">2.5</td>
<td align="right">5.0</td>
<td align="right">2.0</td>
<td align="left">virginica</td>
</tr>
</tbody>
</table>
<p>实际上，在R中我们一般以<code>data.frame</code>的形式储存数据，实际上所面对的就是上面这种数据表格。这种数据表格对于编程人员来说很实用很方便，但对于一般人而言，就会觉得很不直观，比如我们将上面表格中的<code>iris</code>数据等价地变换一下，就会发现这样的问题：</p>
<table>
<thead>
<tr class="header">
<th align="left">Species</th>
<th align="left">Type</th>
<th align="left">Shape</th>
<th align="right">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">setosa</td>
<td align="left">Sepal</td>
<td align="left">Length</td>
<td align="right">4.8</td>
</tr>
<tr class="even">
<td align="left">versicolor</td>
<td align="left">Sepal</td>
<td align="left">Length</td>
<td align="right">5.6</td>
</tr>
<tr class="odd">
<td align="left">virginica</td>
<td align="left">Sepal</td>
<td align="left">Length</td>
<td align="right">5.7</td>
</tr>
<tr class="even">
<td align="left">setosa</td>
<td align="left">Sepal</td>
<td align="left">Width</td>
<td align="right">3.1</td>
</tr>
<tr class="odd">
<td align="left">versicolor</td>
<td align="left">Sepal</td>
<td align="left">Width</td>
<td align="right">2.9</td>
</tr>
<tr class="even">
<td align="left">virginica</td>
<td align="left">Sepal</td>
<td align="left">Width</td>
<td align="right">2.5</td>
</tr>
<tr class="odd">
<td align="left">setosa</td>
<td align="left">Petal</td>
<td align="left">Length</td>
<td align="right">1.6</td>
</tr>
<tr class="even">
<td align="left">versicolor</td>
<td align="left">Petal</td>
<td align="left">Length</td>
<td align="right">3.6</td>
</tr>
<tr class="odd">
<td align="left">virginica</td>
<td align="left">Petal</td>
<td align="left">Length</td>
<td align="right">5.0</td>
</tr>
<tr class="even">
<td align="left">setosa</td>
<td align="left">Petal</td>
<td align="left">Width</td>
<td align="right">0.2</td>
</tr>
<tr class="odd">
<td align="left">versicolor</td>
<td align="left">Petal</td>
<td align="left">Width</td>
<td align="right">1.3</td>
</tr>
<tr class="even">
<td align="left">virginica</td>
<td align="left">Petal</td>
<td align="left">Width</td>
<td align="right">2.0</td>
</tr>
</tbody>
</table>

  
  <div class="read-more-link">
    <a href="/post/2017/02/06/tables-package-usage/">Read More →</a>
  </div>
  
</article><article class="post">
  <h1 class="post-title">
    <a href="/post/2016/10/07/taylor-series-for-uncertainty/">基于泰勒展开的不确定性传递</a>
  </h1>
  <time datetime="2016-10-07T00:00:00Z" class="post-date">2016年10月7日</time>
  


<div id="section" class="section level1">
<h1>1 两个输入变量</h1>
<p>假设随机变量<span class="math inline">\(Z\)</span>是随机变量<span class="math inline">\(X\)</span>和随机变量<span class="math inline">\(Y\)</span>的函数，函数关系如下</p>
<p><span class="math display">\[Z=f(X,Y)\]</span></p>
<p>其中<span class="math inline">\(X\)</span>和<span class="math inline">\(Y\)</span>的均值分别为<span class="math inline">\(\overline{X}\)</span>和<span class="math inline">\(\overline{Y}\)</span>，方差分别为<span class="math inline">\(D_{X}\)</span><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>和<span class="math inline">\(D_{Y}\)</span>，协方差为<span class="math inline">\(D_{XY}\)</span>。对<span class="math inline">\(Z\)</span>进行关于<span class="math inline">\(\overline{X}\)</span>和<span class="math inline">\(\overline{Y}\)</span>泰勒展开可以得到</p>
<p><span class="math display">\[Z=f(\overline{X},\overline{Y})+f_{X}^{\prime}(\overline{X},\overline{Y})(X-\overline{X})+f_{Y}^{\prime}(\overline{X},\overline{Y})(Y-\overline{Y})+o(X,Y)\]</span></p>
<p>如果忽略高阶项<span class="math inline">\(o(X,Y)\)</span>，那么根据随机变量求和的期望和方差计算公式</p>
<p><span class="math display">\[\mathbb{E}(X+Y)=\mathbb{E}(X)+\mathbb{E}(Y)\]</span></p>
<p>和</p>
<p><span class="math display">\[\text{var}(X+Y)=\text{var}(X)+\text{var}(Y)+2\text{cov}(X,Y)\]</span></p>
<p>可以得到<span class="math inline">\(Z\)</span>的期望值与方差值分别如下</p>
<p><span class="math display">\[\overline{Z}=f(\overline{X},\overline{Y})\]</span></p>
<p>和</p>
<p><span class="math display">\[D_{Z}=f_{X}^{\prime}(\overline{X},\overline{Y})^{2}D_{X}+f_{Y}^{\prime}(\overline{X},\overline{Y})^{2}D_{Y}+2f_{X}^{\prime}(\overline{X},\overline{Y})f_{Y}^{\prime}(\overline{X},\overline{Y})D_{XY}\]</span></p>

  
  <div class="read-more-link">
    <a href="/post/2016/10/07/taylor-series-for-uncertainty/">Read More →</a>
  </div>
  
</article>

    <ul class="pagination pagination-default">
      <li class="page-item">
        <a href="/" aria-label="First" class="page-link" role="button"><span aria-hidden="true">&laquo;&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/" aria-label="Previous" class="page-link" role="button"><span aria-hidden="true">&laquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/" aria-label="Page 1" class="page-link" role="button">1</a>
      </li>
      <li class="page-item active">
        <a href="#" aria-current="page" aria-label="Page 2" class="page-link" role="button">2</a>
      </li>
      <li class="page-item">
        <a href="/page/3/" aria-label="Page 3" class="page-link" role="button">3</a>
      </li>
      <li class="page-item">
        <a href="/page/3/" aria-label="Next" class="page-link" role="button"><span aria-hidden="true">&raquo;</span></a>
      </li>
      <li class="page-item">
        <a href="/page/3/" aria-label="Last" class="page-link" role="button"><span aria-hidden="true">&raquo;&raquo;</span></a>
      </li>
    </ul>
</div>
    </main>
<script src="/js/math-code.js"></script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    
  </body>
</html>
